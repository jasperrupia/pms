<!DOCTYPE html>
<html lang="en">
    {% load static %}

<head>
    {% include 'layout/head.html' %}

    <!-- This page CSS -->
    <link rel="stylesheet" href="{% static 'plugins/multicheck/multicheck.css' %}">
    <link href="{% static 'plugins/DataTables/datatables.css' %}" rel="stylesheet">
</head>

<body class="fix-header fix-sidebar card-no-border">
    <!-- ============================================================== -->
    <!-- Preloader - style you can find in spinners.css -->
    <!-- ============================================================== -->
    <div class="preloader">
        <div class="loader">
            <div class="loader__figure"></div>
            <p class="loader__label"> PMS </p>
        </div>
    </div>
    <!-- ============================================================== -->
    <!-- Main wrapper - style you can find in pages.scss -->
    <!-- ============================================================== -->
    <div id="main-wrapper">

        <!-- ============================================================== -->
        <!-- Topbar header - style you can find in pages.scss -->
        <!-- ============================================================== -->
        <header class="topbar">
            <nav class="navbar top-navbar navbar-expand-md navbar-light">
                <!-- ============================================================== -->
                <!-- Logo -->
                <!-- ============================================================== -->
                <div class="navbar-header">
                    <a href=""> <img src="{% static 'assets/pms-logo.jpg' %}" alt="logo" width="70px" /> </a>
                    <span class="dark-logo h3"> PMS </span>
                </div>
                <!-- ============================================================== -->
                <!-- End Logo -->
                <!-- ============================================================== -->
                
                <!-- ============================================================== -->
                <!-- PMS NAME -->
                <!-- ============================================================== -->
                <div class="float-start">
                    <h1> {{ PHARMACY_NAME }} </h1> 
                </div>
        
                <div class="navbar-collapse">
                    <!-- ============================================================== -->
                    <!-- toggle and nav items -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav me-auto">
                        <!-- This is  -->
                        <li class="nav-item"> 
                            <a class="nav-link nav-toggler hidden-md-up waves-effect waves-dark"
                                href="javascript:void(0)"><i class="mdi mdi-menu mdi-24px"></i></a> 
                        </li>
                    </ul>
                    <!-- ============================================================== -->
                    <!-- User profile and search -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav my-lg-0">
                        <!-- ============================================================== -->
                        <!-- Search -->
                        <!-- ============================================================== -->
                        <!-- <li class="nav-item hidden-xs-down search-box"> 
                            <a class="nav-link hidden-sm-down waves-effect waves-dark" href="javascript:void(0)">
                                <i class="mdi mdi-search-web mdi-24px"></i>
                            </a>
                            <form class="app-search">
                                <input type="text" class="form-control" placeholder="Search & enter"> 
                                <a class="srh-btn"> <i class="mdi mdi-close mdi-24px"></i> </a>
                            </form>
                        </li> -->
                        <!-- ============================================================== -->
                        <!-- Profile -->
                        <!-- ============================================================== -->
                        <li class="nav-item dropdown">
                            {% if user.is_authenticated %}
                            
                            <a class="nav-link dropdown-toggle waves-effect waves-dark pro-pic" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="mdi mdi-arrow-down-right-bold"></i>
                                <img src="media/{{ user.avata }}" alt="user" class="rounded-circle" width="31"/>
                                <span class="p-2"> {{ user.username }} </span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end animated shadow-lg p-3" style="width:277px; position:absolute; right:2px; margin-top:2px;" aria-labelledby="navbarDropdown">
                                <div class="text-center">
                                    <img src="media/{{ user.avata }}" style='width: 150px; margin:auto;' class='img-circle img-thumbnail'><br>
                                    <span> {{ user.username }} </span><br>
                                    <span> * {{ user.title }} * </span>
                                </div>
                                <form action="../logout" method="POST">
                                    {% csrf_token %}
                                    <div class="py-3"> 
                                        <a href="../profile"><i class="mdi mdi-account mdi-18px me-1 ms-1"></i> My Profile</a>
                                        <button type="submit" class="btn btn-sm btn-secondary btn-rounded float-end"> <i class="mdi mdi-power mdi-18px"></i> Sign Out </button>
                                    </div>
                                </form>
                            </ul>  
        
                            {% endif %}
                        </li>
                    </ul>
                </div>
            </nav>
        </header>
        <!-- ============================================================== -->
        <!-- End Topbar header -->
        <!-- ============================================================== -->


        <!-- ============================================================== -->
        <!-- Left Sidebar - style you can find in sidebar.scss  -->
        <!-- ============================================================== -->
        <aside class="left-sidebar">
            <!-- Sidebar scroll-->
            <div class="scroll-sidebar">
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        <li> 
                            <a href="../dashboard" class="waves-effect waves-light" aria-expanded="false">
                                <i class="mdi mdi-gauge"></i>
                                <span class="hide-menu"> Dashboard </span>
                            </a>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link has-arrow waves-effect waves-light" href="javascript:void(0)" aria-expanded="false">
                                <i class="mdi mdi-medical-bag"></i><span class="hide-menu"> Medicine </span>
                            </a>
                            <ul aria-expanded="false" class="collapse first-level">
                                <li class="sidebar-item">
                                    <a href="../category" class="sidebar-link waves-effect waves-light">
                                        <i class="mdi mdi-group mdi-18px"></i><span class="hide-menu"> Categories </span>
                                    </a>
                                </li>
                                <li class="sidebar-item">
                                <a href="../stock" class="sidebar-link waves-effect waves-light">
                                    <i class="mdi mdi-store mdi-24px"></i><span class="hide-menu"> Stock </span>
                                  </a>
                              </li>
                            </ul>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link has-arrow waves-effect waves-light" href="javascript:void(0)" aria-expanded="false">
                                <i class="mdi mdi-sale"></i><span class="hide-menu"> Sales </span>
                            </a>
                            <ul aria-expanded="false" class="collapse first-level">
                                <li class="sidebar-item">
                                    <a href="../sell" class="sidebar-link waves-effect waves-light">
                                        <i class="mdi mdi-hand-coin mdi-24px"> </i><span class="hide-menu"> sell </span>
                                    </a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="../records" class="sidebar-link waves-effect waves-light">
                                        <i class="mdi mdi-table mdi-24px"></i> <span class="hide-menu"> Records </span>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="sidebar-item">
                            <a class="sidebar-link has-arrow waves-effect waves-light" href="javascript:void(0)" aria-expanded="false">
                                <i class="mdi mdi-hammer-screwdriver"></i><span class="hide-menu"> Setting </span>
                            </a>
                            <ul aria-expanded="false" class="collapse first-level">
                                <li class="sidebar-item">
                                    <a href="../profile" class="sidebar-link waves-effect waves-light">
                                        <i class="mdi mdi-account mdi-24px"></i><span class="hide-menu"> My profile </span>
                                    </a>
                                </li>
                                {% if user.is_superuser %}
                                <li class="sidebar-item">
                                    <a href="../users" class="sidebar-link waves-effect waves-light">
                                        <i class="mdi mdi-note-plus mdi-24px"></i><span class="hide-menu"> Manage Users </span>
                                    </a>
                                </li>
                                <li class="sidebar-item">
                                    <a href="../pharmacy" class="sidebar-link waves-effect waves-light">
                                        <i class="mdi mdi-hospital-marker mdi-24px"></i><span class="hide-menu"> Pharmacy </span>
                                    </a>
                                </li>
                                {% endif %}
                            </ul>
                        </li>
                    </ul>
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->
        </aside>
        <!-- ============================================================== -->
        <!-- End Left Sidebar - style you can find in sidebar.scss  -->
        <!-- ============================================================== -->


        <!-- ============================================================== -->
        <!-- Page wrapper  -->
        <!-- ============================================================== -->
        <div class="page-wrapper">
            <div class="container-fluid">
                <!-- ============================================================== -->
                <!-- Bread crumb and right sidebar toggle -->
                <!-- ============================================================== -->
                <div class="row page-titles">
                    <div class="col-md-5 align-self-center">
                        <h3 class="text-themecolor"> <i class="mdi mdi-medical-bag"></i> Medicine / <span style="color: #687384;"> Stock / Edit </span></h3>
                    </div>
                </div>
                <!-- ============================================================== -->
                <!-- End Bread crumb and right sidebar toggle -->
                <!-- ============================================================== -->
                
                <!-- ============================================================== -->
                <!-- Contents -->
                <!-- ============================================================== -->
                <div class="row">
                    
                    {% if pharmacy_value < 1 %}
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <symbol id="info-fill" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
                        </symbol>
                    </svg>
                    <div class="alert alert-primary d-flex align-items-center text-center" role="alert">
                        <svg class="bi flex-shrink-0 me-2" width="24" height="24" role="img" aria-label="Info:"><use xlink:href="#info-fill"/></svg>
                        <div>
                            {% if user.title == 'owner' %}
                            INITIATE PHARMACY FIRST <a href="../pharmacy"> >> HERE YOU GO << </a>
                            {% else %}
                            THE OWNER SHOULD INITIATE PHARMACY FIRST
                            {% endif %}
                        </div>
                    </div>
                    {% else %}

                    <div class="card shadow-sm">
                        <div class="card-body">
                            
                            <h5 class="card-title"> Edit Medicine </h5>
                            <div class="table-responsive">
                                <form action="../updStock" method="POST" id="del-sell-form"> 
                                {% csrf_token %}
                                    <input type="hidden" name="id" value="{{ stock_value.id }}">
                                    <table id="zero_config" class="table table-striped table-bordered text-center">
                                        
                                        <tr>
                                            <th> Medicine Name: </th>
                                            <td><input type="text" value="{{ stock_value.name }}" name="medicine_name" class="form-control my-2" required></td>
                                        </tr>
                                        <tr>
                                            <th> Generic Name: </th>
                                            <td><input type="text" value="{{ stock_value.generic_name }}" name="generic_name" class="form-control my-2"></td>
                                        </tr>
                                        <tr>
                                            <th> Category: </th>
                                            <td>
                                                <select class="form-control my-2" name="category_id" required> 
                                                    {% for instance in category_values %}
                                                    <option value="{{ instance.id }}"> {{ instance.name }} </option>
                                                    {% endfor %}
                                                </select> 
                                            </td>
                                        </tr>
                                        <tr>
                                            <th> Quantity: </th>
                                            <td>
                                                <input type="number" value="{{ stock_value.quantity }}"  min='1' class="form-control w-50 my-2" name="quantity" required>
                                                <select class="form-control w-25 my-2" name="packaging" required> 
                                                    <option value="Units"> Units </option>
                                                    <option value="Stp"> Stp </option>
                                                    <option value="Boxes"> Boxes </option>
                                                    <option value="Sachet"> Sachet </option>	
                                                    <option value="Bots"> Bots </option>
                                                    <option value="Tubes"> Tubes </option>
                                                </select>
                                            </td>
                                        </tr>
                                        <tr>
                                            <th> Unit cost: </th>
                                            <td><input type="number" value="{{ stock_value.cost }}" min='300' name="cost" class="form-control my-2" required></td>
                                        </tr>
                                        <tr>
                                            <th> Unit price: </th>
                                            <td><input type="number" value="{{ stock_value.price }}" min='200' name="price" class="form-control my-2" required></td>
                                        </tr> 
                                        <tr>
                                            <th> Expiry: </th>
                                            <td><input type="date" value="{{ stock_value.best_before|date:'Y-m-d' }}" name="best_before" class="form-control my-2" required></td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                                <button type="submit" class="btn btn-primary wave-effect wave-light float-end mt-4 mx-4"> Update </button>
                                            </td>
                                        </tr>
                                        
                                    </table>
                                </form>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Vertically centered modal 1 -->
                    <div class="modal fade" id="add-stock" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title font-bold" id="exampleModalLabel"> Introduce new specific Medicine </h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <form action="addStock" method="GET" id="add-form">
                                        <table>
                                            <tr>
                                                <th> Medicine Name: </th>
                                                <td><input type="text" name="medicine_name" class="form-control my-2" required></td>
                                            </tr>
                                            <tr>
                                                <th> Generic Name: </th>
                                                <td><input type="text" name="generic_name" class="form-control my-2"></td>
                                            </tr>
                                            <tr>
                                                <th> Category: </th>
                                                <td>
                                                    <select class="form-control my-2" name="category_id" required> 
                                                        {% for instance in category_values %}
                                                        <option value="{{ instance.id }}"> {{ instance.name }} </option>
                                                        {% endfor %}
                                                    </select> 
                                                </td>
                                            </tr>
                                            <tr>
                                                <th> Quantity: </th>
                                                <td>
                                                    <input type="number" min='1' class="form-control w-50 my-2" name="quantity" required>
                                                    <select class="form-control w-25 my-2" name="packaging" required> 
                                                        <option value="Units"> Units </option>
                                                        <option value="Stp"> Stp </option>
                                                        <option value="Boxes"> Boxes </option>
                                                        <option value="Sachet"> Sachet </option>	
                                                        <option value="Bots"> Bots </option>
                                                        <option value="Tubes"> Tubes </option>
                                                    </select>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th> Unit cost: </th>
                                                <td><input type="number" min='300' name="cost" class="form-control my-2" required></td>
                                            </tr>
                                            <tr>
                                                <th> Unit price: </th>
                                                <td><input type="number" min='200' name="price" class="form-control my-2" required></td>
                                            </tr> 
                                            <tr>
                                                <th> Expiry: </th>
                                                <td><input type="date" name="best_before" class="form-control my-2" required></td>
                                            </tr>
                                        </table> 
                                    </form>
                                    <!-- end form table -->
                                </div>
                                <div class="modal-footer">
                                    <button type="submit" form="add-form" class="btn btn-success waves-effect waves-light"><i class="mdi mdi-check-bold"></i> Save </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endif %}

                </div>
                <!-- ============================================================== -->
                <!-- End Contents -->
                <!-- ============================================================== -->
                
            </div>

            <!-- ============================================================== -->
            <!-- footer -->
            <!-- ============================================================== -->
            
            <!-- ============================================================== -->
            <!-- End footer -->
            <!-- ============================================================== -->
        </div>
        <!-- ============================================================== -->
        <!-- End Page wrapper  -->
        <!-- ============================================================== -->
    </div>
    <!-- ============================================================== -->
    <!-- End Wrapper -->
    <!-- ============================================================== -->
    
    <!-- ============================================================== -->
    <!-- All Jquery -->
    <!-- ============================================================== -->
    {% include 'layout/scripts.html' %}
    <!-- mult check box -->
    <script src="{% static 'plugins/multicheck/datatable-checkbox-init.js' %}"></script>
    <script src="{% static 'plugins/multicheck/jquery.multicheck.js' %}"></script>
    <!-- Data table -->
    <script src="{% static 'plugins/DataTables/datatables.js' %}"></script>
    <script>    $("#zero_config").DataTable();    </script>
    

</body>

</html>